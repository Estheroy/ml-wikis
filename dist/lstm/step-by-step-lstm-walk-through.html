
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Step-by-Step LSTM Walk Through Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="variants-on-long-short-term-memory.html" />
    
    
    <link rel="prev" href="the-core-idea-behind-lstms.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="chapter1.html">
            
                <a href="chapter1.html">
            
                    
                    What is LSTM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="the-core-idea-behind-lstms.html">
            
                <a href="the-core-idea-behind-lstms.html">
            
                    
                    The Core Idea Behind LSTMs
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4" data-path="step-by-step-lstm-walk-through.html">
            
                <a href="step-by-step-lstm-walk-through.html">
            
                    
                    Step-by-Step LSTM Walk Through
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="variants-on-long-short-term-memory.html">
            
                <a href="variants-on-long-short-term-memory.html">
            
                    
                    Variants on Long Short Term Memory
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="reference.html">
            
                <a href="reference.html">
            
                    
                    Reference
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Step-by-Step LSTM Walk Through</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="step-by-step-lstm-walk-through">Step-by-Step LSTM Walk Through</h2>
<p>(1). The first step in our LSTM is to decide what information we&#x2019;re going to throw away from the cell state. This decision is made by a sigmoid layer called the &#x201C;forget gate layer.&#x201D; It looks at ht&#x2212;1 and xt, and outputs a number between 0 and 1 for each number in the cell state Ct&#x2212;1. A 1 represents &#x201C;completely keep this&#x201D; while a 0 represents &#x201C;completely get rid of this.&#x201D;
Let&#x2019;s go back to our example of a language model trying to predict the next word based on all the previous ones. In such a problem, the cell state might include the gender of the present subject, so that the correct pronouns can be used. When we see a new subject, we want to forget the gender of the old subject.</p>
<p><img src="assets/LSTM_core_idea2.jpg" alt=""></p>
<p>(2) The next step is to decide what new information we&#x2019;re going to store in the cell state. This has two parts. First, a sigmoid layer called the &#x201C;input gate layer&#x201D; decides which values we&#x2019;ll update. Next, a tanh layer creates a vector of new candidate values, C~t, that could be added to the state. In the next step, we&#x2019;ll combine these two to create an update to the state.
In the example of our language model, we&#x2019;d want to add the gender of the new subject to the cell state, to replace the old one we&#x2019;re forgetting.</p>
<p><img src="assets/LSTM_core_idea3.jpg" alt=""></p>
<p>(3) It&#x2019;s now time to update the old cell state, Ct&#x2212;1, into the new cell state Ct. The previous steps already decided what to do, we just need to actually do it.
We multiply the old state by ft, forgetting the things we decided to forget earlier. Then we add it*C~t. This is the new candidate values, scaled by how much we decided to update each state value.
In the case of the language model, this is where we&#x2019;d actually drop the information about the old subject&#x2019;s gender and add the new information, as we decided in the previous steps.</p>
<p><img src="assets/LSTM_core_idea4.jpg" alt=""></p>
<p>(4) Finally, we need to decide what we&#x2019;re going to output. This output will be based on our cell state, but will be a filtered version. First, we run a sigmoid layer which decides what parts of the cell state we&#x2019;re going to output. Then, we put the cell state through tanh (to push the values to be between &#x2212;1 and 1) and multiply it by the output of the sigmoid gate, so that we only output the parts we decided to.
For the language model example, since it just saw a subject, it might want to output information relevant to a verb, in case that&#x2019;s what is coming next. For example, it might output whether the subject is singular or plural, so that we know what form a verb should be conjugated into if that&#x2019;s what follows next.</p>
<p><img src="assets/LSTM_core_idea5.jpg" alt=""></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="the-core-idea-behind-lstms.html" class="navigation navigation-prev " aria-label="Previous page: The Core Idea Behind LSTMs">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="variants-on-long-short-term-memory.html" class="navigation navigation-next " aria-label="Next page: Variants on Long Short Term Memory">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Step-by-Step LSTM Walk Through","level":"1.4","depth":1,"next":{"title":"Variants on Long Short Term Memory","level":"1.5","depth":1,"path":"variants-on-long-short-term-memory.md","ref":"variants-on-long-short-term-memory.md","articles":[]},"previous":{"title":"The Core Idea Behind LSTMs","level":"1.3","depth":1,"path":"the-core-idea-behind-lstms.md","ref":"the-core-idea-behind-lstms.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["autocover","mathjax"],"pluginsConfig":{"autocover":{},"mathjax":{"forceSVG":false,"version":"2.6-latest"},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"step-by-step-lstm-walk-through.md","mtime":"2017-03-13T06:21:39.412Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-03-13T06:23:52.606Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="https://cdn.mathjax.org/mathjax/2.6-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

