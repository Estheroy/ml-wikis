
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Theory and Implementation of RNN Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-disqus/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="the-problem-of-long-term-dependencies.html" />
    
    
    <link rel="prev" href="chapter1.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Abstract
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="chapter1.html">
            
                <a href="chapter1.html">
            
                    
                    What is Recurrent Neural Network
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3" data-path="theory-and-implementation-of-rnn.html">
            
                <a href="theory-and-implementation-of-rnn.html">
            
                    
                    Theory and Implementation of RNN
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="the-problem-of-long-term-dependencies.html">
            
                <a href="the-problem-of-long-term-dependencies.html">
            
                    
                    The Problem of Long-Term Dependencies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="vanishing-gradient.html">
            
                <a href="vanishing-gradient.html">
            
                    
                    Vanishing Gradient
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="what-can-rnns-do.html">
            
                <a href="what-can-rnns-do.html">
            
                    
                    What can RNNs do
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="rnn-extensions.html">
            
                <a href="rnn-extensions.html">
            
                    
                    RNN EXTENSIONS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="reference.html">
            
                <a href="reference.html">
            
                    
                    Reference
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Theory and Implementation of RNN</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="theory-and-implementation-of-rnn">Theory and Implementation of RNN</h2>
<h4 id="forward-learning">FORWARD LEARNING</h4>
<p>Training a RNN is similar to training a traditional Neural Network. Let&#x2019;s get concrete and see what the RNN looks like. </p>
<p><img src="assets/rnn_forward_learning.jpg" alt=""></p>
<p>Then, the forward calculation for each step will be exactly same as traditional neural networks:</p>
<p><script type="math/tex; mode=display">
\begin{gather*}
s_t = tanh(Ux_t + Ws_t - 1)\\
o_t = softmax(Vs_t)
\end{gather*}
</script></p>
<h4 id="backpropagate-the-loss">BACKPROPAGATE THE LOSS</h4>
<p>To train, we will use the backpropagation algorithm, but with a little twist. Because the parameters are shared by all time steps in the network, the gradient at each output depends not only on the calculations of the current time step, but also the previous time steps. </p>
<p><img src="assets/backpropagation_loss.png" alt=""></p>
<p>For example, in order to calculate the gradient at t=3, we would need to backpropagate 3 steps and sum up the gradients. </p>
<p><script type="math/tex; mode=display">
\begin{eqnarray*}
\frac{\partial E_3}{\partial W} =\sum^3_{k=0}\frac{\partial E_3}{\partial \hat{y}_3}
\frac{\partial \hat{y}_3}{\partial s_3}\left(\prod^3_{j=k+1}\frac{\partial s_j}{\partial s_{j-1}}\right)\frac{\partial s_k}{\partial W}
\end{eqnarray*}
</script></p>
<p>This is called Back propagation Through Time (BPTT). Be aware of the fact that vanilla RNNs trained with BPTT have difficulties learning long-term dependencies (e.g. dependencies between steps that are far apart) due to what is called the vanishing/exploding gradient problem, which is the next section. There exists some machinery to deal with these problems, and certain types of RNNs (like LSTMs) were specifically designed to get around them.</p>
<h4 id="calculating-the-loss">CALCULATING THE LOSS</h4>
<p>To train our network we need a way to measure the errors it makes. We call this the loss function L, and our goal is find the parameters W, V and W that minimize the loss function for our training data. A common choice for the loss function is the cross-entropy loss. If we have N training examples (words in our text) and C classes (the size of our vocabulary) then the loss with respect to our predictions O and the true labels y is given by:</p>
<p><script type="math/tex; mode=display">
\begin{eqnarray*}
L(y,o) = -\frac{1}{N}\sum_{n\in N}y_n\log O_n
\end{eqnarray*}
</script></p>
<p>The formula looks a bit complicated, but all it really does is sum over our training examples and add to the loss based on how off our prediction are.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="chapter1.html" class="navigation navigation-prev " aria-label="Previous page: What is Recurrent Neural Network">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="the-problem-of-long-term-dependencies.html" class="navigation navigation-next " aria-label="Next page: The Problem of Long-Term Dependencies">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Theory and Implementation of RNN","level":"1.3","depth":1,"next":{"title":"The Problem of Long-Term Dependencies","level":"1.4","depth":1,"path":"the-problem-of-long-term-dependencies.md","ref":"the-problem-of-long-term-dependencies.md","articles":[]},"previous":{"title":"What is Recurrent Neural Network","level":"1.2","depth":1,"path":"chapter1.md","ref":"chapter1.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["autocover","mathjax","disqus"],"pluginsConfig":{"disqus":{"useIdentifier":false,"shortName":"ai-master"},"search":{},"autocover":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"mathjax":{"forceSVG":false,"version":"2.6-latest"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"theory-and-implementation-of-rnn.md","mtime":"2017-03-06T08:53:32.294Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-03-06T08:57:00.308Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="https://cdn.mathjax.org/mathjax/2.6-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-disqus/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

